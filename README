Building the kernel:

$ cd linux-lts-quantal-3.5.0
$ make menuconfig
$ make
$ su
# make modules_install
# make install

Make a replay cache folder:
$ mkdir /replay_cache/

Record a program:
$ su
# ./launcher <logdir> <program>

Example:
$ sudo ~/omniplay/launcher /tmp/logs /bin/ls

Replay a program:
$ su
# ./resume <logdir>

Example:
$ sudo ~/omniplay/resume /tmp/logs

Building glibc:
$ cd eglibc-2.15/
$ mkdir build
$ mkdir prefix
$ cd build
$ ../configure -prefix=<tree>/eglibc-2.15/prefix --disable-profile --enable-add-on --without-gd --without-selinux --without-cvs --enable-kernel=3.2.0
$ make
$ mkdir /var/db
$ chown <user> /var/db
$ touch ../prefix/etc/ld.so.conf
$ make install

For multi-threaded programs, need to link in our glibc.

To record a program with glibc:
$ sudo ./launcher --pthread eglibc-2.15/prefix/lib <logdir> <program>

To replay a program with glibc:
$ sudo ./resume <logdir> --pthread eglibc-2.15/prefix/lib <logdir> <program>


Debugging:
After a replay, check the kernel buffer for errors
$ dmesg

Use parseklog to examine a kernel log.
$ omniplay/test/parseklog /tmp/logs/klog.id.* > parsed_klog


Building Firefox:
Dependencies (apt-get install these first)
autoconf2.13
autotools-dev
cdbs
dbus-x11
debhelper (>= 7)
hardening-wrapper
libasound2-dev
libcurl4-openssl-dev
libdbus-glib-1-dev (>= 0.60)
libfontconfig1-dev
libfreetype6-dev (>= 2.0.1)
libgconf2-dev (>= 1.2.1)
libglib2.0-dev (>= 2.18)
libgnomeui-dev (>= 2.2.0)
libgtk2.0-dev (>= 2.14)
libiw-dev
libnotify-dev (>= 0.4)
libpango1.0-dev (>= 1.14.0)
libstartup-notification0-dev
libx11-dev
libxext-dev
libxrender-dev
libxt-dev
locales
lsb-release
mesa-common-dev
python (>= 2.7)
quilt
unzip
xvfb
yasm (>= 1.1)
zip

Use the .mzconfig file.
$ make -f client.mk build
